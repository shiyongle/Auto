package com.pc.util;

import java.util.HashMap;

import com.pc.appInterface.api.DongjingClient;
import com.pc.model.Util_UserOnline;



public class ServerContext{
public static String getHswurl() {
		return HswUrl;
	}

	//	private static OracleHelper OracleHelper;
//	private static NumberHelper NumberHelper;
	private static String[] Specialstr;
	//private static final String BaseUrl="http://wl.cpsol.net/DJBank_demo_bak/";
//	private static final String BaseUrl="http://dacuoxiaosa.vicp.cc:47145/DJBankPay";//李阔总部电脑用花生网应射到外网的支付地址
//	private static final String BaseUrl="http://192.168.10.172/DJBankPay";//李娟测试支付
//	private static final String BaseUrl="http://121.40.160.69:8081/DJBankPay";//外网测试支付
	private static final String BaseUrl="http://192.168.1.26/DJBankPay";//测试支付
//	private static final String BaseUrl="http://wl.cpsol.net/DJBankV2";//正式支付
	private static String msg;
	private static final String HswUrl="http://dacuoxiaosa.vicp.cc:15010/DJBankPay";//花生网测试
	
	private static HashMap<String, Util_UserOnline> map = new HashMap<String, Util_UserOnline>();
	public static String getMsg() {
		return msg;
	}
	public static String getBaseurl() {
		return BaseUrl;
	}
	public static void setMsg(String msg) {
		ServerContext.msg = msg;
	}

	private static HashMap<String, String[]> driverPosition = new HashMap<String, String[]>();
	
	public static HashMap<String, Util_UserOnline> getUseronline() throws DJException {
		return map;
	}
	
	public static void setUseronline(String sessionId,Util_UserOnline useronline) throws DJException {
//		if(!map.containsKey(sessionId)){
			map.put(sessionId, useronline);
//		}
	}
	
	public static void delUseronline(String sessionId) throws DJException {
		if(map.containsKey(sessionId)){
			map.remove(sessionId);
		}
	}
	
	public static void delAllUseronline() throws DJException {
		map.clear();
	}
	
	public static void ServerContext() throws DJException {
		Specialstr=new String[]{"--","%","*","'"};
		
	}
	public static String[] getSpecialstr() throws DJException {
		return Specialstr;
	}
	
	
	public static DongjingClient createVmiClient() throws DJException {
		DongjingClient vmiClient=new DongjingClient();
		vmiClient.setURL("http://192.168.10.201/cps/CsclDispatcher");			//李娟测试cps链接;
//		vmiClient.setURL("http://localhost:8080/cps/CsclDispatcher");			//本地测试cps链接;
//		vmiClient.setURL("http://121.40.160.69:8080/cps/CsclDispatcher");			//外网测试cps链接;
//		vmiClient.setURL("http://202.104.136.201:7070/cps/CsclDispatcher");	//正式cps链接;
//		vmiClient.setURL("http://10.117.28.235/cps/CsclDispatcher");		//正式内网cps链接;
		vmiClient.setPassword("csclapp");
		vmiClient.setUsername("csclapp");
		vmiClient.connect();
		return vmiClient;
	}
	//增加服务端校验付款状态，防止直接调用接口修改付款状态   
//	public static boolean checkPayStatus(String data) throws DJException {
//		 DongjingClient PayClient=new DongjingClient();
//		 PayClient.setRequestProperty("data", data);
//		 PayClient.SubmitUrlData("http://192.168.0.89/DJBankPay/Action_Pay/DJPay/Pay/API/Name/UserOrder/Index/UserOrderPayOver?&XDEBUG_SESSION_START=17402");
//		return  PayClient.issuccess();
//	}
	//将发送退款请求放到服务端，确保支付退款与业务系统状态一致 
	public static boolean cancelOrderPay(String url,String PayInfo) throws DJException {
		 DongjingClient PayClient=new DongjingClient();
		 PayClient.setRequestProperty("data", PayInfo);
		 PayClient.SubmitUrlData(url);
		return  PayClient.issuccess();
	}
	
	//将带好运卷的支付
	public static boolean cancelCouponsPay(String url,String PayInfo,String Attached) throws DJException {
		 DongjingClient PayClient=new DongjingClient();
		 PayClient.setRequestProperty("data", PayInfo);
		 PayClient.setRequestProperty("Attached", Attached);
		 PayClient.SubmitUrlData(url);
		return  PayClient.issuccess();
	}
	
	//提现扣除余额结果返回   
		public static boolean checkWithdrawStatus(String data) throws DJException {
			 DongjingClient PayClient=new DongjingClient();
			 PayClient.setRequestProperty("data", data);
			 PayClient.SubmitUrlData(ServerContext.getBaseurl()+"/Action_Pay/DJPay/PaySys/UseMoney?&XDEBUG_SESSION_START=17402");
			return  PayClient.issuccess();
		}

//	//将发送退款请求放到服务端，确保支付退款与业务系统状态一致 
//	public static boolean cancelOrderPay1(String url) throws DJException {
//		 DongjingClient PayClient=new DongjingClient();
//		 PayClient.SubmitUrlData(url);
//		return  PayClient.issuccess();
//	}

	/**
	 * @return the driverPosition
	 */
	public static HashMap<String, String[]> getDriverPosition() {
		return driverPosition;
	}

	/**
	 * @param driverPosition the driverPosition to set
	 */
	public static void setDriverPosition(HashMap<String, String[]> driverPosition) {
		ServerContext.driverPosition = driverPosition;
	}
	
	//当前用户余额
	public static String UsePayBalance(String data) throws DJException {
		DongjingClient PayClient=new DongjingClient();
		PayClient.setRequestProperty("data", data);		
		PayClient.SubmitUrlData(ServerContext.getBaseurl()+"/Action_Pay/DJPay/Pay/API/Name/UserControl/Index/UsePayBalance");
		return  PayClient.getResponse().getResultString();
	}
	
}